function GameException(){this.severity=ERROR_SEVERITY.OK_TO_IGNORE,this.message="",this.title=""}function HTTP_LocalRequest(t){this.filename=t}function EnemyEmptyBehaviour(){}function HTTP_PostRequest(t){this.xmlHttpRequest=null,this.requestURL=t,this.callback=function(){}}function EnemyIdleBehaviour(){this.forward=!1}function EnemyBoss(t,e){this.hitsToKill=e,this.type=ENEMY_TYPES.RED,this.alive=!0,this.game=t,this.hits=0}function EnemySpawn(t,e){this.game=t,this.spawnSprite=this.game.add.sprite(100,100,e),this.spawnNumber=0,this.enemies=[],this.spawns=0}function ScoreBoard(t,e){this.newsRequest=new HTTP_GetRequest(t),this.newsStories=[],this.newsLabels=[],this.phaser=e}function NewsBoard(t,e){this.newsRequest=new HTTP_GetRequest(t),this.newsStories=[],this.newsLabels=[],this.phaser=e}function EnemyActiveBehaviour(){this.onPlayerPlatform=!1,this.setSpeed=!1}function ButtonSet(t){this.phaser=t,this.buttons=[],this.isOver=!1,this.tint="0xFFFFFF",this.onUp=function(){}}function Bullet(t){this.activeBullet=BULLET_TYPE.GREEN,this.game=t,this.sprites=[]}function Player(t){this.projectile=new Bullet(t),this.game=t,this.timeout=!0,this.duration=void 0,this.disableUpdate=!1,this.deaths=0}function HTTP_GetRequest(t){this.xmlHttpRequest=new XMLHttpRequest,this.requestURL=t,this.callback=null}function Level(t,e){this.game=Application.phaser,this.platformGroup=null,this.enemySpawns=[],this.enemyBoss=null,this.platforms=[],this.totalEnemies=0,this.filename=e,this.sceneID="Menu";var i=MobileGame.getLayout(t);if(0!=i)this.LevelData=JSON.parse(i);else{var s=new XMLHttpRequest;s.open("GET",e,!1),s.send(null),200===s.status&&(this.LevelData=JSON.parse(s.responseText),console.log(this.LevelData))}}function Enemy(t,e,i){this.behaviour=new EnemyEmptyBehaviour,this.game=t,this.type=i,this.sprite=this.game.add.sprite(0,0,e),this.sprite.visible=!1,this.alive=!0}var Application={canvasParentElement:"",canvasSize:[1280,720],canvasType:Phaser.AUTO,debug:!1,phaser:null,start:function(t){this.phaser=new Phaser.Game(this.canvasSize[0],this.canvasSize[1],this.canvasType,this.canvasParentElement,this.canvasCallbacks);for(var e=0;e<t.length;e+=2)this.phaser.state.add(t[e],t[e+1]);this.phaser.state.start(t[0])},main:function(){window.addEventListener("DOMContentLoaded",function(){Application.canvasSize=[1280,720],Application.start(["Boot",MobileGame.Boot,"Highscores",MobileGame.Highscores,"Controls",MobileGame.Controls,"GameOver",MobileGame.GameOver,"Preload",MobileGame.Preload,"Credits",MobileGame.Credits,"Menu",MobileGame.MainMenu,"LV1",MobileGame.Level1,"LV2",MobileGame.Level2,"LV3",MobileGame.Level3,"LV4",MobileGame.Level4,"LV5",MobileGame.Level5])})}()},ERROR_SEVERITY={OK_TO_IGNORE:"Ignore",HIGH:"High",LOW:"Low"};GameException.prototype["throw"]=function(){this.severity===ERROR_SEVERITY.OK_TO_IGNORE?(console.log(this.severity),console.log(this.title),console.log(this.message)):(window.alert("Throwing "+this.severity+" problem error"),window.alert(this.title+"\n"+this.message))},GameException.prototype.set=function(t,e,i){this.setSeverity(i),this.setMessage(e),this.setTitle(t)},GameException.prototype.setMessage=function(t){t&&(this.message=t)},GameException.prototype.setSeverity=function(t){t&&(this.severity=t)},GameException.prototype.setTitle=function(t){t&&(this.title=t)};var Browser={fullscreen:!1,toggleFullscreen:function(){this.fullscreen?(document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen(),this.fullscreen=!1):(document.documentElement.requestFullScreen?document.documentElement.requestFullScreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT),this.fullscreen=!0)}};HTTP_LocalRequest.prototype.grab=function(t){var e=new XMLHttpRequest;if(e.open("GET",this.filename,!1),e.send(null),200==e.status)return t?JSON.parse(e.responseText):e.responseText;var i=new GameException;return i.set("Couldnt get local asset",this.filename,SEVERITY.HIGH),i["throw"](),""},EnemyEmptyBehaviour.prototype.update=function(){},EnemyEmptyBehaviour.prototype.platformCollision=function(){},EnemyEmptyBehaviour.prototype.playerCollision=function(){};var MobileGame=MobileGame||{};MobileGame.Boot=MobileGame.Boot||function(){},MobileGame.Boot.prototype={preload:function(){var t=Application.phaser;t.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT,t.stage.backgroundColor="#FFFFFF",t.load.image("loader","data/img/loader.png"),t.load.image("splash","data/img/splash.jpg")},create:function(){Application.phaser.state.start("Preload")}};var MobileGame=MobileGame||{};MobileGame.Level4=function(){},MobileGame.Level4.prototype={preload:function(){this.pointer=Application.phaser.input.activePointer,this.pointer.y=650,this.pointer.x=0,this.game=Application.phaser,this.levelLayout=new Level(LEVEL_LAYOUT_ID.LV4,"data/lvl/level4.txt"),this.uiButtons=new ButtonSet(Application.phaser),this.player=new Player(this.game)},create:function(){var t=this;this.levelLayout.createWorld(),this.player.setup(),this.uiButtons.pushButton("MENU",30,30,"button",this.handleBackButtonPress,this),this.uiButtons.pushButton("SWITCH",1050,30,"button",this.handleToggleButtonPress,this,"0x00FF00"),this.uiButtons.setButtonSetSize(200,75),this.uiButtons.attachText("MENU","Menu","30px Comic Sans MS"),this.uiButtons.attachText("SWITCH","Change Bullet","23px Comic Sans MS"),this.uiButtons.onUp=function(e){e[1].button.tint=t.player.getBulletColour()}},update:function(){this.levelLayout.update(this.player,this.blockGroup),this.player.update(Application.phaser.input.activePointer,this.levelLayout,this.uiButtons.isOver)},render:function(){Application.debug&&(this.game.time.advancedTiming=!0,this.game.debug.text(this.game.time.fps||"--",2,14,"#000000"))},handleToggleButtonPress:function(){this.player.switchProjectile()},handleBackButtonPress:function(){Music.play("menu",!0),this.levelLayout.stopSpawningEnemies(),this.game.state.start("Menu")}};var Music={sounds:[],muted:!1,pause:function(t){for(var e=0;e<this.sounds.length;e++)this.sounds[e].ID==t&&this.sounds[e].obj.pause()},stop:function(t){for(var e=0;e<this.sounds.length;e++)this.sounds[e].ID==t&&this.sounds[e].obj.stop()},play:function(t,e){if(!this.muted){var i;e?(i=Application.phaser.add.audio(t),i.loopFull(1)):(i=Application.phaser.add.audio(t),i.play()),this.sounds.push({ID:t,obj:i})}},hasDecodedTracks:function(){for(var t=0,e=0;e<this.sounds.length;e++)this.sounds[e].isDecoding||t++;return t==this.sounds.length},clear:function(){this.mute(),this.sounds.length=0},mute:function(t){if(this.muted=!this.muted,t){for(var e=0;e<this.sounds.length;e++)if(this.sounds[e].ID==t){this.sounds[e].obj.mute=!this.sounds[e].obj.mute;break}}else for(var e=0;e<this.sounds.length;e++)this.sounds[e].obj.mute=!this.sounds[e].obj.mute}},MobileGame=MobileGame||{};MobileGame.Level5=function(){},MobileGame.Level5.prototype={preload:function(){this.pointer=Application.phaser.input.activePointer,this.pointer.y=650,this.pointer.x=640,this.game=Application.phaser,this.levelLayout=new Level(LEVEL_LAYOUT_ID.LV5,"data/lvl/level5.txt"),this.uiButtons=new ButtonSet(Application.phaser),this.player=new Player(this.game)},create:function(){this.levelLayout.createWorld();var t=this;this.player.setup(),this.player.setPosition(640,650),this.uiButtons.pushButton("MENU",30,30,"button",this.handleBackButtonPress,this),this.uiButtons.pushButton("SWITCH",1050,30,"button",this.handleToggleButtonPress,this,"0x00FF00"),this.uiButtons.setButtonSetSize(200,75),this.uiButtons.attachText("MENU","Menu","30px Comic Sans MS"),this.uiButtons.attachText("SWITCH","Change Bullet","23px Comic Sans MS"),this.uiButtons.onUp=function(e){e[1].button.tint=t.player.getBulletColour()}},update:function(){this.levelLayout.update(this.player,this.blockGroup),this.player.update(Application.phaser.input.activePointer,this.levelLayout,this.uiButtons.isOver)},render:function(){Application.debug&&(this.game.time.advancedTiming=!0,this.game.debug.text(this.game.time.fps||"--",2,14,"#000000"))},handleToggleButtonPress:function(){this.player.switchProjectile()},handleBackButtonPress:function(){Music.play("menu",!0),this.levelLayout.stopSpawningEnemies(),this.game.state.start("Menu")}};var MobileGame=MobileGame||{};MobileGame.Level3=function(){},MobileGame.Level3.prototype={preload:function(){this.pointer=Application.phaser.input.activePointer,this.pointer.y=650,this.pointer.x=0,this.game=Application.phaser,this.levelLayout=new Level(LEVEL_LAYOUT_ID.LV3,"data/lvl/level3.txt"),this.uiButtons=new ButtonSet(Application.phaser),this.player=new Player(this.game)},create:function(){var t=this;this.levelLayout.createWorld(),this.player.setup(),this.uiButtons.pushButton("MENU",30,30,"button",this.handleBackButtonPress,this),this.uiButtons.pushButton("SWITCH",1050,30,"button",this.handleToggleButtonPress,this,"0x00FF00"),this.uiButtons.setButtonSetSize(200,75),this.uiButtons.attachText("MENU","Menu","30px Comic Sans MS"),this.uiButtons.attachText("SWITCH","Change Bullet","23px Comic Sans MS"),this.uiButtons.onUp=function(e){e[1].button.tint=t.player.getBulletColour()}},update:function(){this.levelLayout.update(this.player,this.blockGroup),this.player.update(Application.phaser.input.activePointer,this.levelLayout,this.uiButtons.isOver)},render:function(){Application.debug&&(this.game.time.advancedTiming=!0,this.game.debug.text(this.game.time.fps||"--",2,14,"#000000"))},handleToggleButtonPress:function(){this.player.switchProjectile()},handleBackButtonPress:function(){Music.play("menu",!0),this.levelLayout.stopSpawningEnemies(),this.game.state.start("Menu")}};var MobileGame=MobileGame||{};MobileGame.Level1=function(){},MobileGame.Level1.prototype={preload:function(){this.pointer=Application.phaser.input.activePointer,this.pointer.y=650,this.pointer.x=0,this.game=Application.phaser,this.levelLayout=new Level(LEVEL_LAYOUT_ID.LV1,"data/lvl/level1.txt"),this.uiButtons=new ButtonSet(Application.phaser),this.player=new Player(this.game)},create:function(){var t=this;this.levelLayout.createWorld(),this.player.setup(),this.uiButtons.pushButton("MENU",30,30,"button",this.handleBackButtonPress,this),this.uiButtons.pushButton("SWITCH",1050,30,"button",this.handleToggleButtonPress,this,"0x00FF00"),this.uiButtons.setButtonSetSize(200,75),this.uiButtons.attachText("MENU","Menu","30px Comic Sans MS"),this.uiButtons.attachText("SWITCH","Change Bullet","23px Comic Sans MS"),this.uiButtons.onUp=function(e){e[1].button.tint=t.player.getBulletColour()},Music.play("level",!0)},update:function(){this.levelLayout.update(this.player,this.blockGroup),this.player.update(Application.phaser.input.activePointer,this.levelLayout,this.uiButtons.isOver)},render:function(){Application.debug&&(this.game.time.advancedTiming=!0,this.game.debug.text(this.game.time.fps||"--",2,14,"#000000"))},handleToggleButtonPress:function(){this.player.switchProjectile()},handleBackButtonPress:function(){Music.play("menu",!0),this.levelLayout.stopSpawningEnemies(),this.game.state.start("Menu")}},HTTP_PostRequest.prototype.send=function(t){var e=this;try{this.xmlHttpRequest=new XMLHttpRequest,this.xmlHttpRequest.onload=function(){e.callback(this.responseText)},this.xmlHttpRequest.open("POST",this.requestURL,!1),this.xmlHttpRequest.setRequestHeader("Content-type","application/json"),this.xmlHttpRequest.send(JSON.stringify(t));var i=this.xmlHttpRequest.status;return i>=200&&304>i?!0:!1}catch(s){var o=new GameException;return o.set("HTTP_PostRequest",s.message,ERROR_SEVERITY.OK_TO_IGNORE),o["throw"](),!1}},HTTP_PostRequest.prototype.setCallback=function(t){this.callback=t},HTTP_PostRequest.prototype.setUrl=function(t){this.url=t},EnemyIdleBehaviour.prototype.update=function(t,e){if(this.platform)if(e.visible){var i=t.body.velocity.x;(this.forward&&-50==i||0==i)&&(t.body.velocity.x=50),(!this.forward&&50==i||0==i)&&(t.body.velocity.x=-50),t.x<=this.platform.x&&(this.forward=!0),t.x+t.width>=this.platform.x+this.platform.width&&(this.forward=!1),t.x<=0?(t.body.velocity.x=50,this.forward=!0):t.x+t.width>=1280&&(t.body.velocity.x=-50,this.forward=!1)}else t.body.velocity.x=50},EnemyIdleBehaviour.prototype.platformCollision=function(t,e){this.platform=e},EnemyIdleBehaviour.prototype.playerCollision=function(t,e){e.body.velocity.x=0,e.body.gravity.y=0,e.visible=!1,e.y=-50,e.x=-50,setTimeout(function(){e.body.gravity.y=400,e.visible=!0,e.y=650,e.x=0},3e3)};var MobileGame=MobileGame||{};MobileGame.Controls=function(){},MobileGame.Controls.prototype={preload:function(){this.game=Application.phaser},backPress:function(){this.game.state.start("Menu")},playPress:function(){Music.stop("menu"),this.game.state.start("LV1")},create:function(){this.background=this.game.add.sprite(0,0,"city_background"),this.background.height=720,this.background.width=1280,this.title=this.game.add.text(0,50,"Controls",{font:"150px Comic Sans MS",fill:"#FDFDFD",align:"center"}),this.title.x=this.game.world.centerX-this.title.width/2,this.buttons=new ButtonSet(this.game),this.buttons.pushButton("START",this.game.world.centerX-110,550,"button",this.playPress,this),this.buttons.setButtonSetSize(220,80),this.buttons.attachText("START","Start Game","30px Comic Sans MS"),this.tutorialImages=[];for(var t=215,e=0;3>e;e++)this.tutorialImages[e]=this.game.add.sprite(t,276,"controls"+(1+e).toString()),this.tutorialImages[e].width=250,this.tutorialImages[e].height=200,t+=300;this.buttons.pushButton("BACK",30,30,"back",this.backPress,this)},render:function(){Application.debug&&(this.game.time.advancedTiming=!0,this.game.debug.text(this.game.time.fps||"--",2,14,"#000000"))}};var MobileGame=MobileGame||{};MobileGame.Level2=function(){},MobileGame.Level2.prototype={preload:function(){this.pointer=Application.phaser.input.activePointer,this.pointer.y=650,this.pointer.x=0,this.game=Application.phaser,this.levelLayout=new Level(LEVEL_LAYOUT_ID.LV2,"data/lvl/level2.txt"),this.uiButtons=new ButtonSet(Application.phaser),this.player=new Player(this.game)},create:function(){var t=this;this.levelLayout.createWorld(),this.player.setup(),this.uiButtons.pushButton("MENU",30,30,"button",this.handleBackButtonPress,this),this.uiButtons.pushButton("SWITCH",1050,30,"button",this.handleToggleButtonPress,this,"0x00FF00"),this.uiButtons.setButtonSetSize(200,75),this.uiButtons.attachText("MENU","Menu","30px Comic Sans MS"),this.uiButtons.attachText("SWITCH","Change Bullet","23px Comic Sans MS"),this.uiButtons.onUp=function(e){e[1].button.tint=t.player.getBulletColour()}},update:function(){this.levelLayout.update(this.player,this.blockGroup),this.player.update(Application.phaser.input.activePointer,this.levelLayout,this.uiButtons.isOver)},render:function(){Application.debug&&(this.game.time.advancedTiming=!0,this.game.debug.text(this.game.time.fps||"--",2,14,"#000000"))},handleToggleButtonPress:function(){this.player.switchProjectile()},handleBackButtonPress:function(){Music.play("menu",!0),this.levelLayout.stopSpawningEnemies(),this.game.state.start("Menu")}},EnemyBoss.prototype.setup=function(t,e,i){this.sprite=this.game.add.sprite(t,e,i),this.game.physics.enable(this.sprite,Phaser.Physics.ARCADE),this.behaviour=new EnemyIdleBehaviour,this.alive=!0,this.sprite.body.collideWorldBounds=!0,this.sprite.body.gravity.y=400,this.sprite.body.maxVelocity.x=50},EnemyBoss.prototype.isDead=function(){return!this.alive},EnemyBoss.prototype.kill=function(){this.hits++,this.hits>=this.hitsToKill?(this.sprite.visible=!1,this.alive=!1):this.alive=!0},EnemyBoss.prototype.update=function(t,e,i){var s=this;if(this.sprite.visible){var o=function(t,e){s.behaviour.playerCollision(t,e),PLAYER_SCORE(-10)},a=function(t,e){s.behaviour.platformCollision(t,e)},n=function(t,e){i.handleEnemyCollision(t,e,s.type)?(PLAYER_SCORE(100),s.kill()):PLAYER_SCORE(-1)};this.game.physics.arcade.collide(this.sprite,i.getActiveSprite(),n),this.game.physics.arcade.collide(this.sprite,t,o),this.game.physics.arcade.collide(this.sprite,e,a),s.behaviour.update(s.sprite,t)}},EnemySpawn.prototype.setSpawnNumber=function(t,e,i){if(3==e.length){this.spawnNumber=Number(t);for(var s=0;s<this.spawnNumber;s++){var o=parseInt(Math.abs(3*Math.random()));this.enemies.push(new Enemy(this.game,e[o],o)),i&&i(this.enemies[s],s)}}},EnemySpawn.prototype.setSpawnPosition=function(t,e){this.spawnSprite.x=t,this.spawnSprite.y=e},EnemySpawn.prototype.update=function(t,e,i){var s=0,o=t.isAlive();for(b=0;b<this.spawns;b++)this.enemies[b].update(t.sprite,e,i,o),this.enemies[b].isDead()&&s++;return s},EnemySpawn.prototype.stopSpawning=function(){clearInterval(this.intervalID)},EnemySpawn.prototype.startSpawning=function(t,e,i){var s=this;this.intervalID=setInterval(function(){s.spawns<s.enemies.length&&s.spawns<s.spawnNumber?(s.enemies[s.spawns].spawn(e,i),s.spawns++):clearInterval(s.intervalID)},t)},ScoreBoard.prototype.createNewsBoard=function(t){this.newsBackPlate=this.phaser.add.sprite(900,200,t),this.newsBackPlate.height=800,this.newsBackPlate.width=800,this.newsBackPlate.x=this.phaser.world.centerX-400,this.newsHeader=this.phaser.add.text(1050,220,"Top 5 Highscores",{font:"60px Comic Sans MS",fill:"#FFFFFF",align:"center"}),this.newsHeader.height=100,this.newsHeader.width=500,this.newsHeader.x=this.phaser.world.centerX-250;var e=this;this.newsRequest.onRecieved(function(t){0==e.newsStories.length&&(e.newsStories=t,e.populateNewsBoard(5))}),this.newsRequest.send()},ScoreBoard.prototype.populateNewsBoard=function(t){for(i=0;i<this.newsStories.length&&i<t;i++)this.newsLabels[2*i]=this.phaser.add.text(400,350+60*i,this.newsStories[i].Name.S,{font:"50px Comic Sans MS",fill:"#FDFDFD",align:"left"}),this.newsLabels[2*i+1]=this.phaser.add.text(800,350+60*i,this.newsStories[i].Highscore.N,{font:"50px Comic Sans MS",fill:"#FDFDFD",align:"left"})},NewsBoard.prototype.createNewsBoard=function(t){this.newsBackPlate=this.phaser.add.sprite(500,250,t),this.newsBackPlate.height=350,this.newsBackPlate.width=600,this.newsHeader=this.phaser.add.text(515,260,"News Board",{font:"60px Comic Sans MS",fill:"#FFFFFF",align:"center"}),this.newsHeader.height=50,this.newsHeader.width=200;var e=this;this.newsRequest.onRecieved(function(t){0==e.newsStories.length&&(e.newsStories=t,e.populateNewsBoard(8))}),this.newsRequest.send()},NewsBoard.prototype.populateNewsBoard=function(t){for(i=0;i<this.newsStories.length&&i<t;i++){this.newsLabels[2*i]=this.phaser.add.text(550,330+35*i,this.newsStories[i].Heading.S,{font:"20px Comic Sans MS",fill:"#FDFDFD",align:"left"}),this.newsLabels[2*i+1]=this.phaser.add.text(730,330+35*i,this.newsStories[i].Text.S,{font:"20px Comic Sans MS",fill:"#FDFDFD",align:"left"})}},EnemyActiveBehaviour.prototype.moveTowards=function(t,e){t>=e.x?e.body.velocity.x=50:t<e.x&&(e.body.velocity.x=-50)},EnemyActiveBehaviour.prototype.update=function(t,e){this.currentPlatform&&(e.visible?this.currentPlatform.y==e.y?this.moveTowards(e.x,t):this.setSpeed||(this.setSpeed=!0,this.moveTowards(e.x,t)):t.body.velocity.x=50,t.x<=0?t.body.velocity.x=50:t.x+t.width>=1280&&(t.body.velocity.x=-50))},EnemyActiveBehaviour.prototype.platformCollision=function(t,e){this.currentPlatform!=e&&(this.currentPlatform=e,this.setSpeed=!1)},EnemyActiveBehaviour.prototype.playerCollision=function(t,e){e.body.velocity.x=0,e.body.gravity.y=0,e.visible=!1,e.y=-50,e.x=-50,setTimeout(function(){e.body.gravity.y=400,e.visible=!0,e.y=650,e.x=0},3e3)},ButtonSet.prototype.pushButton=function(t,e,i,s,o,a,n){var r=this.phaser.add.button(e,i,s,o,a),h=this,l=function(){r.tint=h.tint,h.isOver=!1,h.onUp(h.buttons)},u=function(){r.tint="0x333333",h.isOver=!0,Music.play("click")},p=function(){h.isOver=!1,setTimeout(function(){r.tint=h.tint,h.onUp(h.buttons)},100)};r.onInputOver.add(function(){h.isOver=!0,r.tint="0x333333"},this),r.onInputDown.add(u,this),r.onInputOut.add(l,this),r.onInputUp.add(p,this),n&&(r.tint=n),this.buttons.push({id:t.toString(),button:r,text:null})},ButtonSet.prototype.setButtonSetSize=function(t,e){for(i=0;i<this.buttons.length;i++)this.buttons[i].button.height=e,this.buttons[i].button.width=t},ButtonSet.prototype.attachText=function(t,e,s){for(i=0;i<this.buttons.length;i++)if(this.buttons[i].id.toLowerCase()===t.toLowerCase()){var o=this.buttons[i].button;this.buttons[i].text=this.phaser.add.text(0,0,e,{font:s,fill:"#FDFDFD",align:"left"});var a=o.y+o.height/2,n=o.x+o.width/2;return this.buttons[i].text.y=a-this.buttons[i].text.height/2,this.buttons[i].text.x=n-this.buttons[i].text.width/2,!0}return!1};var MobileGame=MobileGame||{};MobileGame.MainMenu=function(){},MobileGame.MainMenu.prototype={preload:function(){this.game=Application.phaser,this.newsBoard||(this.newsBoard=new NewsBoard("http://54.77.243.196:3005/news/GetNews/",this.game))},handlePlayPress:function(){var t=this;setTimeout(function(){t.game.state.start("Controls")},500)},handleHighscorePress:function(){var t=this;setTimeout(function(){t.game.state.start("Highscores")},500)},handleCreditsPress:function(){var t=this;setTimeout(function(){t.game.state.start("Credits")},500)},create:function(){var t=Application.phaser,e=t.add.sprite(0,0,"city_background"),i=t.add.text(0,50,"An Edge of 5 Kingdoms",{font:"100px Comic Sans MS",fill:"#FDFDFD",align:"center"}),s=t.add.text(10,0,"B00235610 & B00236297",{font:"40px Comic Sans MS",fill:"#FDFDFD",align:"center"});s.y=720-s.height,i.x=t.world.centerX-i.width/2,e.height=720,e.width=1280,this.buttons=new ButtonSet(this.game),this.buttons.pushButton("PLAY",200,250,"button",this.handlePlayPress,this),this.buttons.pushButton("SCORES",200,370,"button",this.handleHighscorePress,this),this.buttons.pushButton("CREDITS",200,490,"button",this.handleCreditsPress,this),this.buttons.setButtonSetSize(220,80),this.buttons.attachText("PLAY","Play","40px Comic Sans MS"),this.buttons.attachText("SCORES","Scores","40px Comic Sans MS"),this.buttons.attachText("CREDITS","Credits","40px Comic Sans MS"),this.newsBoard.createNewsBoard("news"),this.newsBoard.populateNewsBoard(8),this.optionButtons=new ButtonSet(this.game),this.optionButtons.pushButton("FULLSCREEN",1160,600,"fullscreen",this.fullscreen,this),this.optionButtons.pushButton("AUDIO",1160,480,"audio",this.mute,this),this.optionButtons.setButtonSetSize(100,100),Music.stop("level")},fullscreen:function(){this.game.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT,this.game.scale.refresh(),this.game.scale.isFullScreen?this.game.scale.stopFullScreen():this.game.scale.startFullScreen()},mute:function(){Music.mute()},render:function(){Application.debug&&(this.game.time.advancedTiming=!0,this.game.debug.text(this.game.time.fps||"--",2,14,"#000000"))}};var BULLET_TYPE={GREEN:0,RED:1,BLACK:2};Bullet.prototype.setup=function(){this.sprites=[this.game.add.sprite(-100,-100,"bullet"),this.game.add.sprite(-100,-100,"bullet1"),this.game.add.sprite(-100,-100,"bullet2")];for(var t=0;3>t;t++)this.game.physics.enable(this.sprites[t],Phaser.Physics.ARCADE),this.sprites[t].body.velocity.x=0,this.sprites[t].body.velocity.y=0,this.sprites[t].body.bounce.setTo(.7,.7),this.sprites[t].height=25,this.sprites[t].width=25},Bullet.prototype.getActiveSprite=function(){return this.sprites[this.activeBullet]},Bullet.prototype.handleEnemyCollision=function(t,e,i){return this.reset(this.activeBullet),this.activeBullet==i},Bullet.prototype.reset=function(t){this.sprites[t].body.collideWorldBounds=!1,this.sprites[t].body.velocity.x=0,this.sprites[t].body.velocity.y=0,this.sprites[t].body.gravity.y=0,this.sprites[t].x=-100,this.sprites[t].y=-100},Bullet.prototype.fire=function(t,e,i,s,o,a){i>2e3&&(i=2e3);var n=.001*i,r=(o-t)*n,h=(a-e)*n;this.sprites[this.activeBullet].body.velocity.y=5*h,this.sprites[this.activeBullet].body.velocity.x=5*r,this.sprites[this.activeBullet].body.collideWorldBounds=!0,this.sprites[this.activeBullet].body.gravity.y=300,this.sprites[this.activeBullet].x=t-12.5,this.sprites[this.activeBullet].y=e-50,Music.play("fire")},Bullet.prototype.update=function(t,e,i,s){0==s&&this.reset(this.activeBullet)},Bullet.prototype.switchType=function(){this.reset(this.activeBullet),this.activeBullet++,this.activeBullet>2&&(this.activeBullet=0)};var MobileGame=MobileGame||{};MobileGame.Credits=function(){},MobileGame.Credits.prototype={preload:function(){this.game=Application.phaser},create:function(){this.background=this.game.add.sprite(0,0,"city_background"),this.buttons=new ButtonSet(Application.phaser),this.buttons.pushButton("BACK",30,30,"back",this.goback,this),this.title=this.game.add.text(0,50,"Credits",{font:"150px Comic Sans MS",fill:"#FDFDFD",align:"center"}),this.title.x=this.game.world.centerX-this.title.width/2,this.footer=this.game.add.text(0,600,'"Made with JavaScript and Phaser 2.3 only"',{font:"40px Comic Sans MS",fill:"#FDFDFD",align:"center"}),this.footer.x=this.game.world.centerX-this.footer.width/2,this.jonathon=this.game.add.button(350,275,"jonathan",this.jonathonPress,this),this.jonathon.height=200,this.jonathon.width=200,this.jonathonText=this.game.add.text(260,500,"B00236297\n  Did the physics, levels design, and input",{font:"20px Comic Sans MS",fill:"#FDFDFD",align:"center"}),this.william=this.game.add.button(780,275,"william",this.williamPress,this),this.william.height=200,this.william.width=200,this.williamText=this.game.add.text(700,500,"B00235610\n  Did the server, http code, and loading",{font:"20px Comic Sans MS",fill:"#FDFDFD",align:"center"})},williamPress:function(){window.open("https://uk.linkedin.com/pub/william-taylor/66/179/32b")},jonathonPress:function(){window.open("https://uk.linkedin.com/in/jlivingstone94")},goback:function(){this.game.state.start("Menu")},render:function(){Application.debug&&(this.game.time.advancedTiming=!0,this.game.debug.text(this.game.time.fps||"--",2,14,"#000000"))}};var MobileGame=MobileGame||{};MobileGame.GameOver=function(){},MobileGame.GameOver.prototype={init:function(t){this.playersScore=t,PLAYER_SCORE(-this.playersScore)},preload:function(){this.game=Application.phaser,this.game.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT},create:function(){this.playersScore||(this.playersScore=100),this.background=this.game.add.sprite(0,0,"city_background"),this.title=this.game.add.text(0,50,"Game Over",{font:"120px Comic Sans MS",fill:"#FDFDFD",align:"center"}),this.title.x=this.game.world.centerX-this.title.width/2,this.back=this.game.add.button(30,30,"back",this.backPress,this),this.back.onInputDown.add(this.backPress,this),this.back.height/=1.5,this.back.width/=1.5,this.score=this.game.add.text(0,250,"Your Score was "+this.playersScore.toString(),{font:"60px Comic Sans MS",fill:"#FDFDFD",align:"center"}),this.score.x=this.game.world.centerX-this.score.width/2,this.buttons=new ButtonSet(this.game),this.buttons.pushButton("SCORES",this.game.world.centerX-110,550,"button",this.highScore,this),this.buttons.setButtonSetSize(220,80),this.buttons.attachText("SCORES","View Highscores","22px Comic Sans MS");var t=this.playersScore.toString();this.timerID=setTimeout(function(){var e=prompt("Enter your name");if(e){var i=new HTTP_PostRequest("http://54.77.243.196:3005/score/postScore/"),s={name:e.toString(),highscore:t,service:"VERSION1"};i.send(s)}},1e3),Music.stop("level"),Music.play("gameover")},highScore:function(){clearTimeout(this.timerID),Music.stop("gameover"),Music.play("menu",!0),this.game.state.start("Highscores")},backPress:function(){clearTimeout(this.timerID),Music.stop("gameover"),Music.play("menu",!0),this.game.state.start("Menu")},render:function(){Application.debug&&(this.game.time.advancedTiming=!0,this.game.debug.text(this.game.time.fps||"--",2,14,"#000000"))}};var PLAYER_SCORE=function(t){var e=t;return function(t){return e+=t}}(0);Player.prototype.setup=function(){this.projectile.setup(),this.sprite=this.game.add.sprite(0,650,"character"),this.sprite.animations.add("walk",[0,1,2,3,4,5]),this.sprite.anchor.setTo(.5,1),Application.phaser.physics.enable(this.sprite,Phaser.Physics.ARCADE),this.sprite.body.gravity.y=400,this.sprite.body.collideWorldBounds=!0},Player.prototype.exitScene=function(){this.sprite.body.collideWorldBounds=!1,this.sprite.body.velocity.x=100,this.disableUpdate=!0},Player.prototype.setPosition=function(t,e){this.sprite.x=t,this.sprite.y=e},Player.prototype.switchProjectile=function(){this.projectile.switchType()},Player.prototype.update=function(t,e,i){this.disableUpdate||(t.msSinceLastClick<=250&&0==this.sprite.body.velocity.y?(this.sprite.body.velocity.y=-350,t.msSinceLastClick=500):t.msSinceLastClick=500,t.isDown&&!i&&(this.duration=t.duration),t.isUp&&(void 0!=this.duration&&this.duration>250&&this.sprite.visible?this.projectile.fire(this.sprite.x,this.sprite.y,this.duration,this.sprite.scale.x,parseInt(t.worldX),parseInt(t.worldY)):this.duration<250&&void 0!=this.duration&&(this.worldX=parseInt(t.worldX),this.worldY=parseInt(t.worldY)),this.duration=void 0),this.worldX>parseInt(this.sprite.x+this.sprite.width/2)?(this.sprite.animations.play("walk",10,!0),this.sprite.body.velocity.x=150,this.actionTaken=!0,-1==this.sprite.scale.x&&(this.sprite.scale.x=1)):this.worldX<parseInt(this.sprite.x-this.sprite.width/2)?(this.sprite.animations.play("walk",10,!0),this.sprite.body.velocity.x=-150,1==this.sprite.scale.x&&(this.sprite.scale.x=-1)):(this.sprite.animations.stop("walk",0),this.sprite.body.velocity.x=0)),this.projectile.update(this.sprite.x,this.sprite.y,this.sprite.visible)},Player.prototype.getBulletColour=function(){switch(this.projectile.activeBullet){case BULLET_TYPE.GREEN:return"0x00FF00";case BULLET_TYPE.BLACK:return"0x000000";case BULLET_TYPE.RED:return"0xFF0000"}return"0xFFFFFF"},Player.prototype.isAlive=function(){return this.sprite.visible},Player.prototype.getScore=function(){return PLAYER_SCORE(0)},Player.prototype.getBulletSprite=function(){return this.projectile.getActiveSprite()};var MobileGame=MobileGame||{};MobileGame.Highscores=function(){},MobileGame.Highscores.prototype={scoreBoardUrl:"http://54.77.243.196:3005/score/GetScores/",scoreBoard:null,preload:function(){this.game=Application.phaser,this.scoreBoard=new ScoreBoard(this.scoreBoardUrl,this.game)},create:function(){this.background=this.game.add.sprite(0,0,"city_background"),this.buttons=new ButtonSet(Application.phaser),this.buttons.pushButton("BACK",30,30,"back",this.goback,this),this.title=this.game.add.text(0,50,"Highscores",{font:"100px Comic Sans MS",fill:"#FDFDFD",align:"center"}),this.title.x=this.game.world.centerX-this.title.width/2,this.scoreBoard.createNewsBoard("news"),this.scoreBoard.populateNewsBoard(5),this.sprite_right=this.game.add.sprite(250,160,"character"),this.sprite_right.animations.add("walk",[0,1,2,3,4,5]),this.sprite_right.animations.play("walk",10,!0),this.sprite_left=this.game.add.sprite(1030,160,"character"),this.sprite_left.animations.add("walk",[0,1,2,3,4,5]),this.sprite_left.animations.play("walk",10,!0),this.sprite_left.scale.x=-1},goback:function(){this.game.state.start("Menu")},render:function(){Application.debug&&(this.game.time.advancedTiming=!0,this.game.debug.text(this.game.time.fps||"--",2,14,"#000000"))}},HTTP_GetRequest.prototype.onRecieved=function(t){this.callback=t},HTTP_GetRequest.prototype.send=function(){try{var t=this;this.xmlHttpRequest.onload=function(){t.callback&&t.callback(JSON.parse(this.responseText))},this.xmlHttpRequest.open("GET",this.requestURL,!0),this.xmlHttpRequest.send(null)}catch(e){var i=new GameException;return i.set("Couldnt execute get request",this.requestURL,SEVERITY.HIGH),i["throw"](),""}};var MobileGame=MobileGame||{};MobileGame.levelLayouts=[];var LEVEL_LAYOUT_ID={LV1:1,LV2:2,LV3:3,LV4:4,LV5:5};MobileGame.getLayout=function(t){return t>=MobileGame.levelLayouts.length?0:MobileGame.levelLayouts[t-1]},MobileGame.Preload=MobileGame.Preload||function(){},MobileGame.Preload.prototype={startingState:"Menu",preload:function(){this.game=Application.phaser,this.game.input.MAX_POINTERS=1,this.background=this.game.add.sprite(0,0,"splash"),this.preloadBar=this.game.add.sprite(640,600,"loader"),this.preloadBar.anchor.setTo(.5),this.game.load.setPreloadSprite(this.preloadBar),this.game.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT,this.game.scale.refresh();
var t=new HTTP_LocalRequest("data/load.txt"),e=t.grab(!0),i=this;this["continue"]=!1;for(var s=0;s<e.assets.length;s++){var o=e.assets[s].type;switch(o){case"spritesheet":this.game.load.spritesheet(e.assets[s].ID,e.assets[s].filename,54,73,11);break;case"image":this.game.load.image(e.assets[s].ID,e.assets[s].filename);break;case"audio":this.game.load.audio(e.assets[s].ID,e.assets[s].filename);break;default:console.log("Unsupported file type")}}var a=new HTTP_PostRequest("http://54.77.243.196:3005/level/getLevel"),i=this;a.setCallback(function(t){MobileGame.levelLayouts.push(t);var e=MobileGame.levelLayouts.length;if(5>e){var s={level:"level"+(e+1).toString()+".json"};a.send(s)}else i["continue"]=!0}),this.skip=a.send({level:"level1.json"})},create:function(){this.game.input.addPointer(),this.game.input.addPointer(),(!this.skip||this["continue"]&&Music.hasDecodedTracks())&&(Music.play("menu",!0),this.game.state.start(this.startingState))}},Level.prototype.stopSpawningEnemies=function(){for(var t=0;t<this.enemySpawns.length;t++)this.enemySpawns[t].stopSpawning()},Level.prototype.createWorld=function(){this.background=Application.phaser.add.sprite(0,0,this.LevelData.Background),this.sceneID=this.LevelData.Next,this.next=this.game.add.sprite(1100,550,"arrow"),this.next.visible=!1;for(var t=0;t<this.LevelData.EnemySpawns.length;t++){var e=this.LevelData.EnemySpawns[t],i=Number(e.SpawnPosition.x),s=Number(e.SpawnPosition.y),o=Number(e.GatePosition.x),a=Number(e.GatePosition.y),n=new EnemySpawn(Application.phaser,e.ID);n.setSpawnPosition(o,a),n.setSpawnNumber(Number(e.Spawns),["enemy1","enemy2","enemy3"],function(t){var i=Math.random();t.behaviour=i>Number(e.Behaviour.Active)?new EnemyActiveBehaviour:new EnemyIdleBehaviour}),n.startSpawning(Number(e.Delay),i,s),this.enemySpawns[t]=n,this.totalEnemies+=Number(e.Spawns)}this.platformGroup=Application.phaser.add.group();for(var t=0;t<this.LevelData.Platforms.length;t++){var e=this.LevelData.Platforms[t],r=e.x,h=e.y,l=e.w,u=e.h;this.platforms[t]=Application.phaser.add.tileSprite(Number(r),Number(h),Number(l),Number(u),e.ID),Application.phaser.physics.enable(this.platforms[t],Phaser.Physics.ARCADE),this.platformGroup.add(this.platforms[t])}if(this.platformGroup.setAll("body.immovable",!0),this.LevelData.Boss){var p=this.LevelData.Boss.ID,c=Number(this.LevelData.Boss.HitPoints),r=Number(this.LevelData.Boss.x),h=Number(this.LevelData.Boss.y);this.enemyBoss=new EnemyBoss(this.game,c),this.enemyBoss.setup(r,h,p)}},Level.prototype.update=function(t){for(this.game.physics.arcade.collide(t.sprite,this.platformGroup),this.game.physics.arcade.collide(t.getBulletSprite(),this.platformGroup),this.dead=0,i=0;i<this.enemySpawns.length;i++)this.dead+=this.enemySpawns[i].update(t,this.platformGroup,t.projectile);null!=this.enemyBoss&&this.enemyBoss.update(t.sprite,this.platformGroup,t.projectile),this.dead>=this.totalEnemies&&(null==this.enemyBoss||this.enemyBoss.isDead())&&(this.next.visible=!0,t.sprite.x>1100&&t.exitScene(),t.sprite.x>1350&&(PLAYER_SCORE(100),this.game.state.start(this.sceneID,!0,!1,t.getScore())))};var ENEMY_TYPES={GREEN:0,RED:1,BLACK:2};Enemy.prototype.update=function(t,e,i,s){var o=this;if(this.sprite.visible){var a=function(t,e){o.behaviour.playerCollision(t,e),PLAYER_SCORE(-10)},n=function(t,e){o.behaviour.platformCollision(t,e)},r=function(t,e){i.handleEnemyCollision(t,e,o.type)?(PLAYER_SCORE(2),o.kill()):(Music.play("fail",!1),PLAYER_SCORE(-1))};s&&(this.game.physics.arcade.collide(this.sprite,i.getActiveSprite(),r),this.game.physics.arcade.collide(this.sprite,t,a)),this.game.physics.arcade.collide(this.sprite,e,n),o.behaviour.update(o.sprite,t)}},Enemy.prototype.isDead=function(){return!this.alive},Enemy.prototype.kill=function(){this.sprite.visible=!1,this.alive=!1,Music.play("taptap",!1)},Enemy.prototype.spawn=function(t,e){this.game.physics.enable(this.sprite,Phaser.Physics.ARCADE),this.alive=!0,this.sprite.body.collideWorldBounds=!0,this.sprite.body.gravity.y=400,this.sprite.visible=!0,this.sprite.x=t,this.sprite.y=e};